<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>@2</title>
  <link href="https://cdn.bootcss.com/semantic-ui/2.3.0/semantic.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="http://unpkg.com/iview/dist/styles/iview.css">
  <link href="https://cdn.bootcss.com/semantic-ui/2.3.0/components/segment.min.css" rel="stylesheet">
  <link href="https://cdn.bootcss.com/semantic-ui/2.3.0/components/card.css" rel="stylesheet">
  <link href="https://cdn.bootcss.com/semantic-ui/2.3.0/components/divider.css" rel="stylesheet">
  <script type="text/javascript" src="http://vuejs.org/js/vue.min.js"></script>
  <script type="text/javascript" src="http://unpkg.com/iview/dist/iview.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>

<body>
  <br>
  <br>
  <br>
  <div id="app" class="ui container">
    <i-row>
      <i-col span="16">
        <c-menu @hello="test"></c-menu>
      </i-col>
      <i-col span="8">
          <c-menu @hello="test"></c-menu>        
      </i-col>
    </i-row>
    <br>
    <br>
    <br>
    <br>
    <br>

    <section class="ui segments">
      <div class="ui segment borderless" v-for="item in siteList">
        <Tag color="#1c2438" v-if="item.top">置顶</Tag>
        <Tag color="#495060" v-if="item.good">精华</Tag>
        <Tag color="#80848f" v-if="item.tab == 'share'"> 分享 </Tag>
        <Tag color="#80848f" v-if="item.tab == 'ask'"> 问答 </Tag>
        <Tag color="#80848f" v-if="item.tab == 'job'"> 工作 </Tag>
        <a :href="'https://cnodejs.org/api/v1/topic/'+item.id">{{item.title}}</a>
      </div>
    </section>

    <footer class="ui center aligned basic segment">
      <div class="ui horizontal divider">特别鸣谢</div>

      <div class="ui centered cards">
        <div class="ui card">
          <div class="ui image">
            <img src="./assets/jsclass.jpg">
          </div>
          <div class="content">
            <a class="header">新生大学JavaScript入门课</a>
            <div class="meta">
              <p class="date">Create in Aug 2017</p>
              <img class="ui avatar image" src="./assets/xgyang.jpg">
              <span>徐高阳</span>
            </div>
          </div>
        </div>
      </div>

    </footer>
  </div>


  <script>

    Vue.component('c-menu', {
      template:
        `<div>
        <Menu mode="horizontal" :theme="'light'" active-name="" @on-select='change'>
            <MenuItem name="" >
                <Icon type="ios-paper"></Icon>
                首页  
            </MenuItem>
            <MenuItem name="good">
                <Icon type="settings"></Icon>
                精华 
            </MenuItem>
            <MenuItem name="ask">
                <Icon type="ios-people"></Icon>
                问答
            </MenuItem>
            <MenuItem name="share">
                <Icon type="settings"></Icon>
                分享
            </MenuItem>
            <MenuItem name="job">
                <Icon type="settings"></Icon>
                招聘
            </MenuItem>
        </Menu>
        <br>
      </div>`,
      data() {
        return {

        }
      },
      methods: {
        change(tag) {
          this.$emit('hello', tag);
        }
      }
    }
    )

    var app = new Vue({
      el: '#app',
      data: {
        siteList: [],
        bar: 0
      },
      methods: {
        fetchData(tab = "", page_number = 0, limit_topic = 20) {
          axios.get('https://cnodejs.org/api/v1/topics', {
            params: {
              tab: tab,
              page: page_number,
              limit: limit_topic
            }
          })
            .then(function (response) {
              if (response.success = 'true') {
                return response.data;
              } else {
                throw new Error("fail to get Data from CNode");
              }
            }).then(function (response) {
              app.siteList = response.data;
            }).catch(
              (err) => console.log(err)
            )
        },
        test(tag) {
          this.fetchData(tag);
        }
      },
      mounted() {
        this.fetchData();
      }
    })
  </script>
</body>

</html>